<!DOCTYPE html>
<html>
  <head>
    <style>
      .user-avatar {
        border-radius: 50%;
        display: block;
        margin: 0 auto;
      }
    </style>

    <title>Snippet Safe</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= stylesheet_link_tag 'application', media: 'all', 'data-turbolinks-track': 'reload' %>

    <%= javascript_pack_tag 'snippet_app' %>
    <%= javascript_pack_tag 'application', 'data-turbolinks-track': 'reload' %>

    <% if content_for? :cache_control %>
      <%= yield :cache_control %>
    <% end %>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.3/styles/atom-one-light.min.css">
    <%# <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.0.1/highlight.min.js"></script> %>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.css" integrity="sha512-w+u2vZqMNUVngx+0GVZYM21Qm093kAexjueWOv9e9nIeYJb1iEfiHC7Y+VvmP/tviQyA5IR32mwN/5hTEJx6Ng==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.9/cropper.min.js" integrity="sha512-9pGiHYK23sqK5Zm0oF45sNBAX/JqbZEP7bSDHyt+nT3GddF+VFIcYNqREt0GDpmFVZI3LZ17Zu9nMMc9iktkCw==" crossorigin="anonymous"></script>
    <%= stylesheet_pack_tag "application", "data-turbo-track": "reload" %>
  </head>

  <body>
    <%= render partial: 'shared/toast' %>
    <%= render partial: 'shared/topbar' %>

            <!--
      This example requires Tailwind CSS v2.0+ 
      
      This example requires some changes to your config:
      
      ```
      // tailwind.config.js
      module.exports = {
        // ...
        plugins: [
          // ...
          require('@tailwindcss/forms'),
        ]
      }
      ```
    -->
    <div class="max-w-6xl mx-auto py-4 sm:px-6 lg:px-8">
      <div class="min-h-screen bg-gray-100">
        <!-- When the mobile menu is open, add `overflow-hidden` to the `body` element to prevent double scrollbars -->
        <!-- On: "fixed inset-0 z-40 overflow-y-auto", Off: "undefined" -->

        <div class="max-w-3xl mx-auto lg:max-w-7xl lg:grid lg:grid-cols-12 lg:gap-8">
          <main class="lg:col-span-9 xl:col-span-9">
            <%= yield %>
          </main>
          <aside class="xl:block xl:col-span-3">
            <div class="sticky position-sticky--topbar space-y-4">

              <% if user_signed_in? %>
                <%= 
                  button_tag(
                    'NEW SNIPPET',
                    class: 'w-full button--cta-primary flex justify-center',
                    data: {
                      controller: 'modal',
                      action: 'modal#present',
                      modal_url_value: new_modals_snippet_path(folder_id: new_snippet_folder_id)
                    }
                  )
                %>
              <% else %>
                <%= 
                  button_tag(
                    'NEW SNIPPET',
                    class: 'w-full button--cta-primary flex justify-center',
                    data: {
                      controller: 'modal',
                      action: 'modal#present',
                      modal_url_value: sign_in_sign_up_modals_users_path
                    }
                  )
                %>
              <% end %>

              <%= render 'shared/cards/card_no_padding' do %>
                <h4 class="text-center pt-2">
                  <%= link_to 'Connect', connect_path, title: 'Search for people to connect with' %>
                </h4>

                <ul class="divide-y divide-gray-200" data-infinite-scroll-window-target="entries" data-action="scroll@window->infinite-scroll-window#scroll">
                  <% if user_signed_in? %>
                    <% User.not_followed_by(current_user).order(Arel.sql('RANDOM()')).limit(3).each do |user| %>
                      <%= render partial: 'users/connect', locals: { user: user }%>
                    <% end %>
                  <% else %>
                      <% User.order(Arel.sql('RANDOM()')).limit(3).each do |user| %>
                        <%= render partial: 'users/connect', locals: { user: user }%>
                      <% end %>
                  <% end %>
                </ul>
              <% end %>

              <%# <%= render 'shared/cards/card' do %>
                <%# <h4 class="text-center">Popular</h4> %>
              <%# <% end %>

            </div>
          </aside>
        </div>
      </div>
    </div>

  </body>
</html>
